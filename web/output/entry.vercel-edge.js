var Pe=Object.defineProperty;var Oe=(e,t,n)=>t in e?Pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var M=(e,t,n)=>(Oe(e,typeof t!="symbol"?t+"":t,n),n);import{getNotFound as Ne}from"./@qwik-city-not-found-paths.js";import{isStaticPath as G}from"./@qwik-city-static-paths.js";import{v as ke,_ as ve,a as Le}from"./q-DHKiNrXx.js";import{s as We,m as $e,r as Ie}from"./q-UMIfxgeJ.js";import{q as He}from"./q-BfLIHRuB.js";function J(e,t){let n="Server Error";return t!=null&&(typeof t.message=="string"?n=t.message:n=String(t)),"<html>"+Ue(e,n)+"</html>"}function Ue(e,t){typeof e!="number"&&(e=500),typeof t=="string"?t=ze(t):t="";const n=typeof t=="string"?"600px":"300px",r=e>=500?je:Fe;return`
<head>
  <meta charset="utf-8">
  <meta http-equiv="Status" content="${e}">
  <title>${e} ${t}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { color: ${r}; background-color: #fafafa; padding: 30px; font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Roboto, sans-serif; }
    p { max-width: ${n}; margin: 60px auto 30px auto; background: white; border-radius: 4px; box-shadow: 0px 0px 50px -20px ${r}; overflow: hidden; }
    strong { display: inline-block; padding: 15px; background: ${r}; color: white; }
    span { display: inline-block; padding: 15px; }
  </style>
</head>
<body><p><strong>${e}</strong> <span>${t}</span></p></body>
`}var Qe=/[&<>]/g,ze=e=>e.replace(Qe,t=>{switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";default:return""}}),Fe="#006ce9",je="#713fc2",Ee={lax:"Lax",Lax:"Lax",None:"None",none:"None",strict:"Strict",Strict:"Strict"},Be={seconds:1,minutes:1*60,hours:1*60*60,days:1*60*60*24,weeks:1*60*60*24*7},X=(e,t,n)=>{const r=[`${e}=${t}`];typeof n.domain=="string"&&r.push(`Domain=${n.domain}`),typeof n.maxAge=="number"?r.push(`Max-Age=${n.maxAge}`):Array.isArray(n.maxAge)?r.push(`Max-Age=${n.maxAge[0]*Be[n.maxAge[1]]}`):typeof n.expires=="number"||typeof n.expires=="string"?r.push(`Expires=${n.expires}`):n.expires instanceof Date&&r.push(`Expires=${n.expires.toUTCString()}`),n.httpOnly&&r.push("HttpOnly"),typeof n.path=="string"&&r.push(`Path=${n.path}`);const s=Ge(n.sameSite);return s&&r.push(`SameSite=${s}`),n.secure&&r.push("Secure"),r.join("; ")};function Y(e){try{return decodeURIComponent(e)}catch{return e}}var Ke=e=>{const t={};if(typeof e=="string"&&e!==""){const n=e.split(";");for(const r of n){const s=r.indexOf("=");s!==-1&&(t[Y(r.slice(0,s).trim())]=Y(r.slice(s+1).trim()))}}return t};function Ge(e){if(e===!0)return"Strict";if(e===!1)return"None";if(e)return Ee[e]}var C=Symbol("request-cookies"),k=Symbol("response-cookies"),A=Symbol("live-cookies"),Lt,Wt,$t,ue,Je=(ue=class{constructor(e){M(this,Lt);M(this,Wt,{});M(this,$t,{});M(this,"appendCounter",0);this[C]=Ke(e),this[A]={...this[C]}}get(e,t=!0){const n=this[t?A:C][e];return n?{value:n,json(){return JSON.parse(n)},number(){return Number(n)}}:null}getAll(e=!0){return Object.keys(this[e?A:C]).reduce((t,n)=>(t[n]=this.get(n),t),{})}has(e,t=!0){return!!this[t?A:C][e]}set(e,t,n={}){this[A][e]=typeof t=="string"?t:JSON.stringify(t);const r=typeof t=="string"?t:encodeURIComponent(JSON.stringify(t));this[k][e]=X(e,r,n)}append(e,t,n={}){this[A][e]=typeof t=="string"?t:JSON.stringify(t);const r=typeof t=="string"?t:encodeURIComponent(JSON.stringify(t));this[k][++this.appendCounter]=X(e,r,n)}delete(e,t){this.set(e,"deleted",{...t,maxAge:0}),this[A][e]=null}headers(){return Object.values(this[k])}},Lt=C,Wt=k,$t=A,ue),Xe=(e,t)=>{const n=t.headers();if(n.length>0){const r=new Headers(e);for(const s of n)r.append("Set-Cookie",s);return r}return e},E=class extends Error{constructor(e,t){super(typeof t=="string"?t:void 0),this.status=e,this.data=t}},$=class{},B=class extends ${},de=class extends ${constructor(e){super(),this.pathname=e}},V=new WeakMap,Z="qaction",Ye="qfunc",q="qdata";function Ve(e,t){const n=ne(e),r=ee(e),s=ne(t),a=ee(t);return he(e,n,r,t,s,a)}function he(e,t,n,r,s,a){let o=null;for(;t<n;){const i=e.charCodeAt(t++),c=r.charCodeAt(s++);if(i===91){const l=pe(e,t),f=t+(l?3:0),h=j(e,f,n,93),d=e.substring(f,h),m=j(e,h+1,n,47),g=e.substring(h+1,m);t=h+1;const w=s-1;if(l){const b=qe(d,g,r,w,a,e,t+g.length+1,n);if(b)return Object.assign(o||(o={}),b)}const S=j(r,w,a,47,g);if(S==-1)return null;const T=r.substring(w,S);if(!l&&!g&&!T)return null;s=S,(o||(o={}))[d]=decodeURIComponent(T)}else if(i!==c&&!(isNaN(c)&&Ze(e,t)))return null}return te(e,t)&&te(r,s)?o||{}:null}function Ze(e,t){return e.charCodeAt(t)===91&&pe(e,t+1)}function ee(e){const t=e.length;return t>1&&e.charCodeAt(t-1)===47?t-1:t}function te(e,t){const n=e.length;return t>=n||t==n-1&&e.charCodeAt(t)===47}function ne(e){return e.charCodeAt(0)===47?1:0}function pe(e,t){return e.charCodeAt(t)===46&&e.charCodeAt(t+1)===46&&e.charCodeAt(t+2)===46}function j(e,t,n,r,s=""){for(;t<n&&e.charCodeAt(t)!==r;)t++;const a=s.length;for(let o=0;o<a;o++)if(e.charCodeAt(t-a+o)!==s.charCodeAt(o))return-1;return t-a}function qe(e,t,n,r,s,a,o,i){n.charCodeAt(r)===47&&r++;let c=s;const l=t+"/";for(;c>=r;){const f=he(a,o,i,n,c,s);if(f){let d=n.substring(r,Math.min(c,s));return d.endsWith(l)&&(d=d.substring(0,d.length-l.length)),f[e]=decodeURIComponent(d),f}const h=et(n,r,l,c,r-1)+l.length;if(c===h)break;c=h}return null}function et(e,t,n,r,s){let a=e.lastIndexOf(n,r);return a==r-n.length&&(a=e.lastIndexOf(n,r-n.length-1)),a>t?a:s}var tt=async(e,t,n,r)=>{if(!Array.isArray(e))return null;for(const s of e){const a=s[0],o=Ve(a,r);if(!o)continue;const i=s[1],c=s[3],l=new Array(i.length),f=[];i.forEach((m,g)=>{re(m,f,w=>l[g]=w,n)});const h=nt(t,r);let d;return re(h,f,m=>d=m==null?void 0:m.default,n),f.length>0&&await Promise.all(f),[a,o,l,d,c]}return null},re=(e,t,n,r)=>{if(typeof e=="function"){const s=V.get(e);if(s)n(s);else{const a=e();typeof a.then=="function"?t.push(a.then(o=>{r!==!1&&V.set(e,o),n(o)})):a&&n(a)}}},nt=(e,t)=>{if(e){t=t.endsWith("/")?t:t+"/";const n=e.find(r=>r[0]===t||t.startsWith(r[0]+(t.endsWith("/")?"":"/")));if(n)return n[1]}},rt=e=>e&&typeof e.then=="function";function at(e){const t=[];return e==="day"?e=60*60*24:e==="week"?e=60*60*24*7:e==="month"?e=60*60*24*30:e==="year"?e=60*60*24*365:e==="private"?e={private:!0,noCache:!0}:e==="immutable"?e={public:!0,immutable:!0,maxAge:60*60*24*365}:e==="no-cache"&&(e={noCache:!0}),typeof e=="number"&&(e={maxAge:e,sMaxAge:e}),e.immutable&&t.push("immutable"),e.maxAge&&t.push(`max-age=${e.maxAge}`),e.sMaxAge&&t.push(`s-maxage=${e.sMaxAge}`),e.noStore&&t.push("no-store"),e.noCache&&t.push("no-cache"),e.private&&t.push("private"),e.public&&t.push("public"),e.staleWhileRevalidate&&t.push(`stale-while-revalidate=${e.staleWhileRevalidate}`),e.staleIfError&&t.push(`stale-if-error=${e.staleIfError}`),t.join(", ")}var v;import("node:async_hooks").then(e=>{const t=e.AsyncLocalStorage;v=new t,globalThis.qcAsyncRequestStore=v}).catch(e=>{console.warn("AsyncLocalStorage not available, continuing without it. This might impact concurrent server calls.",e)});function st(e,t,n,r,s=!0,a="/",o){let i;const c=new Promise(f=>i=f),l=ot(e,t,n,s,a,o,i);return{response:c,requestEv:l,completion:v?v.run(l,ae,l,r,i):ae(l,r,i)}}async function ae(e,t,n){let r=1;async function s(){try{await e.next()}catch(a){if(a instanceof B)await e.getWritableStream().close();else if(a instanceof de){if(r>50)throw new Error("Infinite rewrite loop");r+=1;const o=new URL(e.url);o.pathname=a.pathname;const{loadedRoute:i,requestHandlers:c}=await t(o);return e.resetRoute(i,c,o),await s()}else if(a instanceof E){if(!e.headersSent){const o=a.status,i=e.request.headers.get("Accept");if(i&&!i.includes("text/html")){const c=e[O];e.headers.set("Content-Type","application/qwik-json"),e.send(o,await c._serializeData(a.data,!0))}else{const c=J(a.status,a.data);e.html(o,c)}}}else if(!(a instanceof $)){if(U(e)!=="dev")try{e.headersSent||(e.headers.set("content-type","text/html; charset=utf-8"),e.cacheControl({noCache:!0}),e.status(500));const o=e.getWritableStream();if(!o.locked){const i=o.getWriter();await i.write(Q.encode(J(500,"Internal Server Error"))),await i.close()}}catch{console.error("Unable to render error page")}return a}}}try{return await s()}finally{e.isDirty()||n(null)}}function se(e,t){if(e.endsWith(D)){const n=e.length-me+(t?1:0);e=e.slice(0,n),e===""&&(e="/")}return e}var P="@isQData",D="/q-data.json",me=D.length,ge=Symbol("RequestEvLoaders"),we=Symbol("RequestEvMode"),ye=Symbol("RequestEvRoute"),O=Symbol("RequestEvQwikSerializer"),Se=Symbol("RequestEvTrailingSlash"),be="@routeName",I="@actionId",Re="@actionFormData",it="@nonce",_e="@rewrite";function ot(e,t,n,r,s,a,o){const{request:i,platform:c,env:l}=e,f=new Map,h=new Je(i.headers.get("cookie")),d=new Headers,m=new URL(i.url);m.pathname.endsWith(D)&&(m.pathname=m.pathname.slice(0,-me),r&&!m.pathname.endsWith("/")&&(m.pathname+="/"),f.set(P,!0));let g=-1,w=null,S,T=e.locale,b=200;const xe=async()=>{for(g++;g<n.length;){const u=n[g],p=globalThis.qcAsyncRequestStore,y=p!=null&&p.run?p.run(R,u,R):u(R);rt(y)&&await y,g++}},Ce=(u,p,y=m)=>{t=u,n=p,m.pathname=y.pathname,m.search=y.search,g=-1},x=()=>{if(w!==null)throw new Error("Response already sent")},N=(u,p)=>{if(x(),typeof u=="number"){b=u;const _=R.getWritableStream().getWriter();_.write(typeof p=="string"?Q.encode(p):p),_.close()}else if(b=u.status,u.headers.forEach((y,_)=>{_.toLowerCase()!=="set-cookie"&&d.append(_,y)}),u.headers.getSetCookie().forEach(y=>{const _=y.indexOf("=");if(_===-1)return;const De=y.slice(0,_).trim(),Me=y.slice(_+1).trim();h.set(De,Me)}),u.body){const y=R.getWritableStream();u.body.pipeTo(y)}else R.getWritableStream().getWriter().close();return z()},z=()=>(g=ie,new $),F={},R={[ge]:F,[we]:e.mode,[Se]:r,get[ye](){return t},[O]:a,cookie:h,headers:d,env:l,method:i.method,signal:i.signal,originalUrl:new URL(m),get params(){return(t==null?void 0:t[1])??{}},get pathname(){return m.pathname},platform:c,get query(){return m.searchParams},request:i,url:m,basePathname:s,sharedMap:f,get headersSent(){return w!==null},get exited(){return g>=ie},get clientConn(){return e.getClientConn()},next:xe,resetRoute:Ce,exit:z,cacheControl:(u,p="Cache-Control")=>{x(),d.set(p,at(u))},resolveValue:async u=>{const p=u.__id;if(u.__brand==="server_loader"&&!(p in F))throw new Error("You can not get the returned data of a loader that has not been executed for this request.");return F[p]},status:u=>typeof u=="number"?(x(),b=u,u):b,locale:u=>(typeof u=="string"&&(T=u),T||""),error:(u,p)=>(b=u,new E(u,p)),redirect:(u,p)=>{if(x(),b=u,p){const y=p.replace(/([^:])\/{2,}/g,"$1/");p!==y&&console.warn(`Redirect URL ${p} is invalid, fixing to ${y}`),d.set("Location",y)}return u>301&&!d.get("Cache-Control")&&d.set("Cache-Control","no-store"),z(),new B},rewrite:u=>{if(x(),u.startsWith("http"))throw new Error("Rewrite does not support absolute urls");return f.set(_e,!0),new de(u.replace(/\/+/g,"/"))},defer:u=>typeof u=="function"?u:()=>u,fail:(u,p)=>(x(),b=u,{failed:!0,...p}),text:(u,p)=>(d.set("Content-Type","text/plain; charset=utf-8"),N(u,p)),html:(u,p)=>(d.set("Content-Type","text/html; charset=utf-8"),N(u,p)),parseBody:async()=>S!==void 0?S:S=lt(R,f,a),json:(u,p)=>(d.set("Content-Type","application/json; charset=utf-8"),N(u,JSON.stringify(p))),send:N,isDirty:()=>w!==null,getWritableStream:()=>{if(w===null){if(e.mode==="dev"){const u=f.get("@serverTiming");u&&d.set("Server-Timing",u.map(p=>`${p[0]};dur=${p[1]}`).join(","))}w=e.getWritableStream(b,d,h,o,R)}return w}};return Object.freeze(R)}function H(e){return e[ge]}function K(e){return e[Se]}function ct(e){return e[ye]}function U(e){return e[we]}var ie=Number.MAX_SAFE_INTEGER,lt=async({request:e,method:t,query:n},r,s)=>{var a;const o=((a=e.headers.get("content-type"))==null?void 0:a.split(/[;,]/,1)[0].trim())??"";if(o==="application/x-www-form-urlencoded"||o==="multipart/form-data"){const i=await e.formData();return r.set(Re,i),ft(i)}else{if(o==="application/json")return await e.json();if(o==="application/qwik-json"){if(t==="GET"&&n.has(q)){const i=n.get(q);if(i)try{return s._deserializeData(decodeURIComponent(i))}catch{}}return s._deserializeData(await e.text())}}},ft=e=>[...e.entries()].reduce((n,[r,s])=>(r.split(".").reduce((a,o,i,c)=>{if(o.endsWith("[]")){const l=o.slice(0,-2);return a[l]=a[l]||[],a[l]=[...a[l],s]}return i<c.length-1?a[o]=a[o]||(Number.isNaN(+c[i+1])?{}:[]):a[o]=s},n),n),{});function ut(e){const{params:t,request:n,status:r,locale:s,originalUrl:a}=e,o={};n.headers.forEach((w,S)=>o[S]=w);const i=e.sharedMap.get(I),c=e.sharedMap.get(Re),l=e.sharedMap.get(be),f=e.sharedMap.get(it),h=e.request.headers,d=new URL(a.pathname+a.search,a),m=h.get("X-Forwarded-Host"),g=h.get("X-Forwarded-Proto");return m&&(d.port="",d.host=m),g&&(d.protocol=g),{url:d.href,requestHeaders:o,locale:s(),nonce:f,containerAttributes:{"q:route":l},qwikcity:{routeName:l,ev:e,params:{...t},loadedRoute:ct(e),response:{status:r(),loaders:H(e),action:i,formData:c}}}}var dt=(e,t,n,r,s)=>{const a=[],o=[],i=[],c=!!(t&&yt(t[2]));if(e&&oe(a,o,i,e,c,n),t){const l=t[0];r&&(n==="POST"||n==="PUT"||n==="PATCH"||n==="DELETE")&&(i.unshift(bt),r==="lax-proto"&&i.push(St)),c&&((n==="POST"||n==="GET")&&i.push(mt),i.push(gt),i.push(At));const f=t[2];i.push(_t),oe(a,o,i,f,c,n),c&&(i.push(h=>{h.sharedMap.set(be,l)}),i.push(ht(o,a)),i.push(s))}return i},oe=(e,t,n,r,s,a)=>{for(const o of r){typeof o.onRequest=="function"?n.push(o.onRequest):Array.isArray(o.onRequest)&&n.push(...o.onRequest);let i;switch(a){case"GET":{i=o.onGet;break}case"POST":{i=o.onPost;break}case"PUT":{i=o.onPut;break}case"PATCH":{i=o.onPatch;break}case"DELETE":{i=o.onDelete;break}case"OPTIONS":{i=o.onOptions;break}case"HEAD":{i=o.onHead;break}}if(typeof i=="function"?n.push(i):Array.isArray(i)&&n.push(...i),s)for(const c of Object.values(o))typeof c=="function"&&(c.__brand==="server_loader"?e.push(c):c.__brand==="server_action"&&t.push(c))}};function ht(e,t){return async n=>{if(n.headersSent){n.exit();return}const{method:r}=n,s=H(n),a=U(n)==="dev",o=n[O];if(a&&r==="GET"&&n.query.has(Z)&&console.warn(`Seems like you are submitting a Qwik Action via GET request. Qwik Actions should be submitted via POST request.
Make sure your <form> has method="POST" attribute, like this: <form method="POST">`),r==="POST"){const i=n.query.get(Z);if(i){const c=globalThis._qwikActionsMap,l=e.find(f=>f.__id===i)??(c==null?void 0:c.get(i));if(l){n.sharedMap.set(I,i);const f=await n.parseBody();if(!f||typeof f!="object")throw new Error(`Expected request data for the action id ${i} to be an object`);const h=await ce(n,l.__validators,f,a);if(!h.success)s[i]=n.fail(h.status??500,h.error);else{const d=a?await W(n,l.__qrl.getSymbol().split("_",1)[0],()=>l.__qrl.call(n,h.data,n)):await l.__qrl.call(n,h.data,n);a&&L(o,d,l.__qrl),s[i]=d}}}}if(t.length>0){const i=t.map(c=>{const l=c.__id;return s[l]=ce(n,c.__validators,void 0,a).then(f=>f.success?a?W(n,c.__qrl.getSymbol().split("_",1)[0],()=>c.__qrl.call(n,n)):c.__qrl.call(n,n):n.fail(f.status??500,f.error)).then(f=>(typeof f=="function"?s[l]=f():(a&&L(o,f,c.__qrl),s[l]=f),f)),s[l]});await Promise.all(i)}}}async function ce(e,t,n,r){let s={success:!0,data:n};if(t)for(const a of t)if(r?s=await W(e,"validator$",()=>a.validate(e,n)):s=await a.validate(e,n),s.success)n=s.data;else return s;return s}function pt(e){return e?typeof e=="object"&&Symbol.asyncIterator in e:!1}async function mt(e){const t=e.query.get(Ye);if(t&&e.request.headers.get("X-QRL")===t&&e.request.headers.get("Content-Type")==="application/qwik-json"){e.exit();const n=U(e)==="dev",r=e[O],s=await e.parseBody();if(Array.isArray(s)){const[a,...o]=s;if(wt(a)&&a.getHash()===t){let i;try{n?i=await W(e,`server_${a.getSymbol()}`,()=>a.apply(e,o)):i=await a.apply(e,o)}catch(c){throw c instanceof E?e.error(c.status,c.data):e.error(500,"Invalid request")}if(pt(i)){e.headers.set("Content-Type","text/qwik-json-stream");const l=e.getWritableStream().getWriter();for await(const f of i){n&&L(r,f,a);const h=await r._serializeData(f,!0);if(e.signal.aborted)break;await l.write(Q.encode(`${h}
`))}l.close()}else{L(r,i,a),e.headers.set("Content-Type","application/qwik-json");const c=await r._serializeData(i,!0);e.send(200,c)}return}}throw e.error(500,"Invalid request")}}function gt(e){const t=K(e),{basePathname:n,originalUrl:r,sharedMap:s}=e,{pathname:a,search:o}=r;if(!s.has(P)&&a!==n&&!a.endsWith(".html")){if(t){if(!a.endsWith("/"))throw e.redirect(301,a+"/"+o)}else if(a.endsWith("/"))throw e.redirect(301,a.slice(0,a.length-1)+o)}}function L(e,t,n){try{e._verifySerializable(t,void 0)}catch(r){throw r instanceof Error&&n.dev&&(r.loc=n.dev),r}}var wt=e=>typeof e=="function"&&typeof e.getSymbol=="function";function yt(e){const t=e[e.length-1];return t&&typeof t.default=="function"}function Ae(e,t){e=new URL(e),e.pathname.endsWith(D)&&(e.pathname=e.pathname.slice(0,-D.length)),t?e.pathname.endsWith("/")||(e.pathname+="/"):e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1));const n=e.search.slice(1).replaceAll(/&?q(action|data|func)=[^&]+/g,"");return`${e.pathname}${n?`?${n}`:""}${e.hash}`}var Q=new TextEncoder;function St(e){Te(e,"lax-proto")}function bt(e){Te(e)}function Te(e,t){if(xt(e.request.headers,"application/x-www-form-urlencoded","multipart/form-data","text/plain")){const r=e.request.headers.get("origin"),s=e.url.origin;let a=r!==s;if(a&&t&&s.startsWith("https://")&&(r==null?void 0:r.slice(4))===s.slice(5)&&(a=!1),a)throw e.error(403,`CSRF check failed. Cross-site ${e.method} form submissions are forbidden.
The request origin "${r}" does not match the server origin "${s}".`)}}function Rt(e){return async t=>{if(t.headersSent||t.sharedMap.has(P))return;t.request.headers.forEach((h,d)=>h);const r=t.headers;r.has("Content-Type")||r.set("Content-Type","text/html; charset=utf-8");const s=K(t),{readable:a,writable:o}=new TextEncoderStream,i=t.getWritableStream(),c=a.pipeTo(i,{preventClose:!0}),l=o.getWriter(),f=t.status();try{const h=U(t)==="static",d=ut(t),m=await e({base:t.basePathname+"build/",stream:l,serverData:d,containerAttributes:{"q:render":h?"static":"",...d.containerAttributes}}),g={loaders:H(t),action:t.sharedMap.get(I),status:f!==200?f:200,href:Ae(t.url,s)};typeof m.html=="string"&&await l.write(m.html),t.sharedMap.set("qData",g)}finally{await l.ready,await l.close(),await c}await i.close()}}async function _t(e){if(!e.sharedMap.has(P))return;try{await e.next()}catch(a){if(!(a instanceof B))throw a}if(e.headersSent)return;const n=e.status(),r=e.headers.get("Location");if(n>=301&&n<=308&&r){const a=Tt(r);if(a){e.headers.set("Location",a),e.getWritableStream().close();return}else e.status(200),e.headers.delete("Location")}}async function At(e){if(!e.sharedMap.has(P)||(await e.next(),e.headersSent||e.exited))return;const n=e.status(),r=e.headers.get("Location"),s=K(e);e.request.headers.forEach((l,f)=>l),e.headers.set("Content-Type","application/json; charset=utf-8");const a={loaders:H(e),action:e.sharedMap.get(I),status:n!==200?n:200,href:Ae(e.url,s),redirect:r??void 0,isRewrite:e.sharedMap.get(_e)},o=e.getWritableStream().getWriter(),c=await e[O]._serializeData(a,!0);o.write(Q.encode(c)),e.sharedMap.set("qData",a),o.close()}function Tt(e){if(e.startsWith("/")){const t=D,n=new URL(e,"http://localhost");return(n.pathname.endsWith("/")?n.pathname.slice(0,-1):n.pathname)+(t.startsWith("/")?"":"/")+t+n.search}else return}function le(){return typeof performance<"u"?performance.now():0}async function W(e,t,n){const r=le();try{return await n()}finally{const s=le()-r;let a=e.sharedMap.get("@serverTiming");a||e.sharedMap.set("@serverTiming",a=[]),a.push([t,s])}}function xt(e,...t){var n;const r=((n=e.get("content-type"))==null?void 0:n.split(/;/,1)[0].trim())??"";return t.includes(r)}async function Ct(e,t,n){const{render:r,qwikCityPlan:s,checkOrigin:a}=t,o=e.url.pathname,i=se(o,s.trailingSlash),c=await fe(s,i,e.request.method,a??!0,r);if(c){const[l,f]=c;return st(e,l,f,async d=>{const m=se(d.pathname,s.trailingSlash),g=await fe(s,m,e.request.method,a??!0,r);if(g){const[w,S]=g;return{loadedRoute:w,requestHandlers:S}}else return{loadedRoute:null,requestHandlers:[]}},s.trailingSlash,s.basePathname,n)}return null}async function fe(e,t,n,r,s){const{routes:a,serverPlugins:o,menus:i,cacheModules:c}=e,l=await tt(a,i,c,t),f=dt(o,l,n,r,Rt(s));return f.length>0?[l,f]:null}var Dt="x-vercel-ip-country",Mt="x-real-ip",Pt="__vdpl",Ot="VERCEL_SKEW_PROTECTION_ENABLED",Nt="VERCEL_DEPLOYMENT_ID",kt="BASE_URL";function vt(e){const t={_deserializeData:Le,_serializeData:ve,_verifySerializable:ke};e.manifest&&We(e.manifest);async function n(r){try{const s=new URL(r.url);if(G(r.method,s))return new Response(null,{headers:{"x-middleware-next":"1"}});const a=globalThis.process,o={mode:"server",locale:void 0,url:s,request:r,env:{get(l){return a.env[l]}},getWritableStream:(l,f,h,d)=>{const{readable:m,writable:g}=new TransformStream;if(o.env.get(Ot)){const S=o.env.get(Nt)||"",T=o.env.get(kt)||"/";r.headers.has("Sec-Fetch-Dest")&&h.set(Pt,S,{path:T,secure:!0,sameSite:!0,httpOnly:!0})}const w=new Response(m,{status:l,headers:Xe(f,h)});return d(w),g},platform:{},getClientConn:()=>({ip:r.headers.get(Mt)??void 0,country:r.headers.get(Dt)??void 0})},i=await Ct(o,e,t);if(i){i.completion.then(f=>{f&&console.error(f)});const l=await i.response;if(l)return l}const c=G(r.method||"GET",s)?"Not Found":Ne(s.pathname);return new Response(c,{status:404,headers:{"Content-Type":"text/html; charset=utf-8","X-Not-Found":s.pathname}})}catch(s){return console.error(s),new Response(String(s||"Error"),{status:500,headers:{"Content-Type":"text/plain; charset=utf-8","X-Error":"vercel-edge"}})}}return n}const jt=vt({render:Ie,qwikCityPlan:He,manifest:$e});export{jt as default};
